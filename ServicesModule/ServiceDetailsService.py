import ServicesModule.InformationExtraction as IE
import ServicesModule.MarkovChains as MC
#import PreprocessingModule.discourse as disc
import ServicesModule.AssignTimestamps as AT

def do(meetingscript, actors, timeStamps):
    #editedmeetingscript = disc.coref_resolved(meetingscript)
    #meetingscript = "Hello everyone I hope you are all fine and well. I want to introduce myself first. I am nour a BA at Microsoft I will be responsible for your project from day one till it is live. I need to be sure that you are hearing me well and the connection is stable before we begin. It’s all perfect Nour, we want to thank you for your time, and we are ready to begin. Hello, Nour how are you? I am fine thanks for asking nice to meet you all. I will walk you through our agenda for today’s meeting. First, we need to determine the business goals in the most abstract way then we will go through them in details to ensure that we cover all the business requirements. So, lets begin with introducing the business for now. Ok let’s begin, Befit is a gym starts with a small branch in el-corba and then it gets bigger and bigger right now we have 143 branches in Egypt 19 in KSA 7 in UAE and 3 in Qatar. Our organization main quarter is in Egypt we depend on excel sheets, forms, and mailing system to manage our work but with this growth it’s almost impossible to keep it under control. Also, we are not just a gym we are offering nutrition and physical plans, weekly sessions for multiple fitness sports and a spa. Our users average age is from 16 to 35. As employees we have HR, finance, training , sales , management departments and also an on spot contracts with fitness coaches for our sessions. Now Yasemin will walk you through the functionalities of our work. Hello Nour I am Yasemin the CEO of befit. I would like to illustrate to you how we work with a scenario. It starts with our sales team, an excel sheet of expected customers info is given to each team member the sales member contacts the customer and present to them befit’s offers and benefits then the sales member will continue the process with the customer and hand him over one of our trainers or if he is interested with our weekly sessions like Zumba, CrossFit, etc. He will continue his booking process that includes making a schedule that fits him and telling him our rules. But in the first case the trainer will ask the customer for his nutrition data which is height, weight, body mass and the rest of the data he needs along with the inbody report that the customer could do it at one of our gyms in his first day. This is done through paper forms and saved in excel sheets. After this the trainer will give the customer his nutrition and physical plan that meets his goals which is predetermined from him while filling the forms. Of course, this process is recorded in formal records and here is an example for the records, forms, and sheets. Perfect this is very helpful, but I have a question for you, does the trainer just analyze this document or use it in another task? No, he uses this information in performing some equations to determine the values of calories, carbs, protein, physical rate, and the rest of the data needed to make the customer’s plan. Ok perfect. the customer also can ask for private trainer to help him and supervise him day by day, and finally he can submit feedback or a complaint by filling a paper form. Perfect that’s all about the customer? Yes, I hope. Ok let us stop here and we can continue this process in a higher level of details next meeting which will be next Sunday. OK perfect Thank you. thank you Nour. you are welcome. Thanks very much and see you soon."
    sentences = MC.services(meetingscript, actors) #meeting script #actors
    serviceDetails = IE.getServices(sentences)
    serviceDetailsStamped = AT.AssignTimestamps(serviceDetails, timeStamps)
    return serviceDetailsStamped